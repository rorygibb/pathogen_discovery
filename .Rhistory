strip.text = element_text(size=13),
legend.position="none",
legend.text = element_text(size=11),
axis.text = element_text(size=11))
p1
p1 = ggplot(curve_preds[ curve_preds$model %in% c(1930, 1960),  ]) +
geom_point(aes(Year, Discovered), size=1.5, col="grey60", alpha=0.8) +
geom_line(aes(Year, median, group=factor(model2))) +
geom_ribbon(aes(Year, ymin=q0.025, ymax=q0.975, fill=factor(model2)), alpha=0.3) +
theme_classic() +
scale_fill_viridis_d( name="Time epoch", begin=0.2, end=0.5) +
#ggtitle(Hmisc::capitalize(daty$Host[1])) +
#ylab(expression(lambda)) +
ylab("Viral discovery rate (viruses/year)") +
xlab("Year") +
ylim(0, 12) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=12),
axis.title.x = element_text(size=11),
legend.title = element_text(size=12),
strip.text = element_text(size=13),
legend.position="none",
legend.text = element_text(size=11),
axis.text = element_text(size=11))
p1
ggsave(p1, file="./output/figures/Cetartiodactyla_discovery_points_2.png", device="png", units="in", width=4.5, height=4, dpi=600, scale=0.8)
p1 = ggplot(curve_preds[ curve_preds$model %in% c(1930, 1960),  ]) +
geom_point(aes(Year, Discovered), size=1.5, col="grey60", alpha=0.8) +
geom_line(aes(Year, median, group=factor(model2))) +
geom_ribbon(aes(Year, ymin=q0.025, ymax=q0.975, fill=factor(model2)), alpha=0.3) +
theme_classic() +
scale_fill_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
#ggtitle(Hmisc::capitalize(daty$Host[1])) +
#ylab(expression(lambda)) +
ylab("Viral discovery rate (viruses/year)") +
xlab("Year") +
ylim(0, 12) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=12),
axis.title.x = element_text(size=11),
legend.title = element_text(size=12),
strip.text = element_text(size=13),
legend.position="bottom",
legend.text = element_text(size=11),
axis.text = element_text(size=11))
ggsave(p1, file="./output/figures/Cetartiodactyla_discovery_points_3_leg.png", device="png", units="in", width=4.5, height=4, dpi=600, scale=0.8)
p1 = ggplot(curve_preds[ curve_preds$model %in% c(1930, 1960),  ]) +
geom_point(aes(Year, Discovered), size=1.5, col="grey60", alpha=0.8) +
geom_line(aes(Year, median, group=factor(model2))) +
geom_ribbon(aes(Year, ymin=q0.025, ymax=q0.975, fill=factor(model2)), alpha=0.3) +
theme_classic() +
scale_fill_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
#ggtitle(Hmisc::capitalize(daty$Host[1])) +
#ylab(expression(lambda)) +
ylab("Viral discovery rate (viruses/year)") +
xlab("Year") +
ylim(0, 12) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=12),
axis.title.x = element_text(size=11),
legend.title = element_text(size=12),
strip.text = element_text(size=13),
legend.text = element_text(size=11),
axis.text = element_text(size=11))
p1
p1 = ggplot(curve_preds[ curve_preds$model %in% c(1930, 1960, 1990),  ]) +
geom_point(aes(Year, Discovered), size=1.5, col="grey60", alpha=0.8) +
geom_line(aes(Year, median, group=factor(model2))) +
geom_ribbon(aes(Year, ymin=q0.025, ymax=q0.975, fill=factor(model2)), alpha=0.3) +
theme_classic() +
scale_fill_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
#ggtitle(Hmisc::capitalize(daty$Host[1])) +
#ylab(expression(lambda)) +
ylab("Viral discovery rate (viruses/year)") +
xlab("Year") +
ylim(0, 12) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=12),
axis.title.x = element_text(size=11),
legend.title = element_text(size=12),
strip.text = element_text(size=13),
legend.text = element_text(size=11),
axis.text = element_text(size=11))
ggsave(p1, file="./output/figures/Cetartiodactyla_discovery_points_3_leg.png", device="png", units="in", width=6, height=4, dpi=600, scale=0.8)
p1 = ggplot(curve_preds[ curve_preds$model %in% c(1930, 1960, 1990),  ]) +
geom_point(aes(Year, Discovered), size=1.5, col="grey60", alpha=0.8) +
geom_line(aes(Year, median, group=factor(model2))) +
geom_ribbon(aes(Year, ymin=q0.025, ymax=q0.975, fill=factor(model2)), alpha=0.6) +
theme_classic() +
scale_fill_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
#ggtitle(Hmisc::capitalize(daty$Host[1])) +
#ylab(expression(lambda)) +
ylab("Viral discovery rate (viruses/year)") +
xlab("Year") +
ylim(0, 12) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=12),
axis.title.x = element_text(size=11),
legend.title = element_text(size=12),
strip.text = element_text(size=13),
legend.text = element_text(size=11),
axis.text = element_text(size=11))
ggsave(p1, file="./output/figures/Cetartiodactyla_discovery_points_3_leg.png", device="png", units="in", width=6, height=4, dpi=600, scale=0.8)
fixed = read.csv("./output/order_models/fixedeffects_allspecies_byorder_inlabrupois_20200106.csv")
head(fixed)
fixed = fixed[ fixed$HostOrder != "Didelphimorphia", ]
fixed$model2 = paste(fixed$model, "-2010", sep="")
#ggplot(fixed[ fixed$param %in% c("yearx") & fixed$model != "2000", ]) +
p2 = ggplot(fixed[ fixed$param %in% c("yearx"), ]) +
geom_point(aes(HostOrder, median, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_linerange(aes(HostOrder, ymin=q0.025, ymax=q0.975, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_hline(yintercept=0, lty=2) +
theme_minimal() +
ylab(expression(beta[year])) +
scale_color_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=16),
axis.title.x = element_blank(),
legend.title = element_text(size=12),
legend.text = element_text(size=11),
axis.text.y = element_text(size=11),
axis.text.x = element_text(size=11, angle=90))
p2
clover %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus))
cl = clover %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus))
fixed = read.csv("./output/order_models/fixedeffects_allspecies_byorder_inlabrupois_20200106.csv")
fixed = left_join(fixed, cl)
head(fixed)
fixed = read.csv("./output/order_models/fixedeffects_allspecies_byorder_inlabrupois_20200106.csv")
fixed = left_join(fixed, cl)
fixed = fixed[ order(fixed$vrich, decreasing = TRUE), ]
fixed = fixed[! fixed$HostOrder %in% c("Didelphimorphia", "Diprotodontia", "Eulipotyphla"), ]
fixed$model2 = paste(fixed$model, "-2010", sep="")
#ggplot(fixed[ fixed$param %in% c("yearx") & fixed$model != "2000", ]) +
p2 = ggplot(fixed[ fixed$param %in% c("yearx"), ]) +
geom_point(aes(HostOrder, median, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_linerange(aes(HostOrder, ymin=q0.025, ymax=q0.975, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_hline(yintercept=0, lty=2) +
theme_minimal() +
ylab(expression(beta[year])) +
scale_color_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=16),
axis.title.x = element_blank(),
legend.title = element_text(size=12),
legend.text = element_text(size=11),
axis.text.y = element_text(size=11),
axis.text.x = element_text(size=11, angle=90))
p2
fixed$HostOrder = factor(fixed$HostOrder, levels=unique(fixed$HostOrder), ordered=TRUE)
fixed$model2 = paste(fixed$model, "-2010", sep="")
#ggplot(fixed[ fixed$param %in% c("yearx") & fixed$model != "2000", ]) +
p2 = ggplot(fixed[ fixed$param %in% c("yearx"), ]) +
geom_point(aes(HostOrder, median, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_linerange(aes(HostOrder, ymin=q0.025, ymax=q0.975, col=model2, group=model2), position=position_dodge(width=0.5)) +
geom_hline(yintercept=0, lty=2) +
theme_minimal() +
ylab(expression(beta[year])) +
scale_color_viridis_d( name="Time epoch", begin=0.2, end=0.7) +
theme(plot.title=element_text(size=14, hjust=0.5),
axis.title.y = element_text(size=16),
axis.title.x = element_blank(),
legend.title = element_text(size=12),
legend.text = element_text(size=11),
axis.text.y = element_text(size=11),
axis.text.x = element_text(size=11, angle=90))
p2
ggsave(p2, file="./output/figures/Order_Betaestimates_20201203_forpresentation.png", device="png", dpi=300, width=8, height=5, units="in", scale=0.95)
ggsave(p2, file="./output/figures/Order_Betaestimates_20201203_forpresentation.png", device="png", dpi=300, width=8, height=5, units="in", scale=0.85)
cl1 = clover %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus))
cl1 = clover %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
col1
cl1
cl2 = clover[ clover$Year <= 2000, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl2
cl2 = clover[ clover$Year <= 1995, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl2
cl3 = clover[ clover$Year <= 1990, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3
cl2 = clover[ clover$Year <= 1990, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3 = clover[ clover$Year <= 1970, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3
cl1 = clover[ clover$HostOrder == "Cetartiodactyla", ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl1
cl1 = clover[ clover$HostOrder == "Cetartiodactyla" & clover$Domestic == FALSE, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl1
cl1 = clover[ clover$Domestic == FALSE, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl2 = clover[ clover$Domestic == FALSE & clover$Year <= 1990, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3 = clover[ clover$Domestic == FALSE & clover$Year <= 1970, ] %>%
group_by(HostOrder) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl1
cl2
cl3
cl1 = clover[ clover$HostOrder == "Cetartiodactyla" & clover$Domestic == FALSE, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl2 = clover[ clover$HostOrder == "Cetartiodactyla" &  clover$Domestic == FALSE & clover$Year <= 1990, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3 = clover[clover$HostOrder == "Cetartiodactyla" &  clover$Domestic == FALSE & clover$Year <= 1970, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl1
cl2
cl3
cl1 = clover[ clover$HostOrder == "Cetartiodactyla" & clover$Domestic == FALSE, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl2 = clover[ clover$HostOrder == "Cetartiodactyla" &  clover$Domestic == FALSE & clover$Year <= 1995, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl3 = clover[clover$HostOrder == "Cetartiodactyla" &  clover$Domestic == FALSE & clover$Year <= 1980, ] %>%
group_by(Host) %>%
dplyr::summarise(vrich = n_distinct(Virus)) %>%
dplyr::arrange(desc(vrich))
cl1
cl2
cl3
table = data.frame(
v1980 = cl3$Host, v1995=cl2$Host, v2010 = cl1$Host
)
table = data.frame(
v1980 = cl3$Host[1:10], v1995=cl2$Host[1:10], v2010 = cl1$Host[1:10]
)
table
table = data.frame(
rank = 1:15, v1980 = cl3$Host[1:15], v1995=cl2$Host[1:15], v2010 = cl1$Host[1:15]
)
table
library(ggpubr)
ggtexttable(table)
table = data.frame(
v1980 = cl3$Host[1:15], v1995=cl2$Host[1:15], v2010 = cl1$Host[1:15]
)
library(ggpubr)
ggtexttable(table)
?table_cell_bg
ggtexttable(table)
table = data.frame(
`1980` = cl3$Host[1:15], `1995`=cl2$Host[1:15], `2010` = cl1$Host[1:15]
)
library(ggpubr)
ggtexttable(table)
table = data.frame(
`1980` = cl3$Host, `1995`=cl2$Host, `2010` = cl1$Host
)
table = data.frame(
`Vdiv 1980` = cl3$Host[1:15], `Vdiv 1995`=cl2$Host[1:15], `Vdiv 2010` = cl1$Host[1:15]
)
library(ggpubr)
ggtexttable(table)
tt = ggtexttable(table)
ggsave(tt, file="./output/figures/Cetartio_table_rank.png", device="png", dpi=300, width=8, height=9, units="in")
cl3
which(cl3$Host == "Giraffa camelopardalis")
table = data.frame(
`Vdiv 1980` = cl3$Host[1:20], `Vdiv 1995`=cl2$Host[1:20], `Vdiv 2010` = cl1$Host[1:20]
)
library(ggpubr)
tt = ggtexttable(table)
ggsave(tt, file="./output/figures/Cetartio_table_rank.png", device="png", dpi=300, width=8, height=9, units="in")
pacman::p_load("dplyr", "magrittr", "stringr", "ggplot2", "inlabru", "INLA")
# domestic species to label
domestic = read.csv("./data/clover/domestic_status/HostLookup_Domestic.csv", stringsAsFactors = FALSE)
# associations data and no humans
clover = read.csv("./data/clover/Clover_v1.0_NBCIreconciled_20201218.csv", stringsAsFactors = FALSE) %>%
#dplyr::filter(Host != "Homo sapiens") %>%
dplyr::mutate(Domestic = ifelse(Host %in% domestic$Host, TRUE, FALSE)) %>%
dplyr::filter(DetectionMethod != "Not specified") %>%
dplyr::filter(!is.na(Year))
# total viral richness by order
tr = clover %>%
group_by(Host) %>%
dplyr::summarise(VRichness = n_distinct(Virus))
# # publication effort by year
# # this needs some thought and work if it's worth including
# pubs = read.csv("./output/host_effort/PubMed_Hosts_PubsByYear_Final.csv", stringsAsFactors = FALSE) %>%
#   dplyr::filter(Note == "") %>%
#   dplyr::select(1:3) %>%
#   dplyr::rename("HostSpecies" = Host)
# unique associations by year
dd = clover %>%
dplyr::group_by(Host, Virus) %>%
dplyr::summarise(HostOrder = head(HostOrder, 1),
HostFamily = head(HostFamily, 1),
Database = paste(unique(Database), collapse=", "),
NumRecords = length(Year),
Year = min(Year, na.rm=TRUE),
YearLatest = max(Year, na.rm=TRUE),
Domestic = head(Domestic, 1)) %>%
left_join(tr) %>%
dplyr::arrange(desc(VRichness), Host, Year)
# create cumulative curves of all years
curves = expand.grid(unique(dd$Host), 1930:2010) %>%
dplyr::rename("Host" = 1, "Year" = 2) %>%
left_join(dd[ , c("Host", "Year", "Virus")]) %>%
dplyr::group_by(Host, Year) %>%
dplyr::summarise(Discovered = sum(!is.na(Virus)),
Virus = paste(unique(Virus), collapse=", ")) %>%
left_join(dd[ !duplicated(dd$Host), c("Host", "HostOrder", "HostFamily", "VRichness", "Domestic") ]) %>%
dplyr::arrange(desc(VRichness), Host, Year) %>%
dplyr::group_by(Host) %>%
dplyr::mutate(VirusCumulative = cumsum(Discovered))
# # publications
# curves = left_join(curves, pubs) %>%
#   dplyr::mutate(NumPubs = replace(NumPubs, is.na(NumPubs), 0))
# ====================== 3. Analysis of stability of relative viral richness estimates over time ===========================
# 1. Order-level comparison of mean viral richness across species
# mean viral richness across species within each order
getOrderVRich = function(year){
resx = curves %>%
dplyr::filter(Year <= year) %>%
dplyr::filter(Host != "Homo sapiens") %>%
dplyr::filter(Domestic == FALSE) %>%
dplyr::group_by(Host) %>%
dplyr::summarise(VRich = sum(Discovered),
HostOrder = head(HostOrder, 1)) %>%
dplyr::group_by(HostOrder) %>%
dplyr::summarise(VRich_Mean = mean(VRich),
VRich_Median = median(VRich),
VRich_SEM = plotrix::std.error(VRich)) %>%
dplyr::arrange(desc(VRich_Mean)) %>%
dplyr::mutate(Year = year)
return(resx)
}
ord_over_time = do.call(rbind.data.frame, lapply(seq(1950, 2010, by=5), getOrderVRich))
oot = reshape2::dcast(ord_over_time[ , c("HostOrder", "Year", "VRich_Mean")], HostOrder ~ Year, value.var="VRich_Mean")
# calculate spearman rank correlation between 2015 and all other years (examine temporal decay)
cor_rho = function(x){ return( as.vector(cor.test(oot$`2010`, x, method="spearman")$estimate) ) }
stab1 = as.data.frame(apply(oot[ , 2:ncol(oot)], 2, cor_rho)) %>%
rename("rho" = 1) %>%
dplyr::mutate(year = seq(1950, 2010, by=5),
model = "Order")
# 2. Family-level comparison of mean viral richness across species
# mean viral richness across species within each order
getFamilyVRich = function(year){
resx = curves %>%
dplyr::filter(Year <= year) %>%
dplyr::filter(Host != "Homo sapiens") %>%
dplyr::filter(Domestic == FALSE) %>%
dplyr::group_by(Host) %>%
dplyr::summarise(VRich = sum(Discovered),
HostFamily = head(HostFamily, 1),
HostOrder = head(HostOrder, 1)) %>%
dplyr::group_by(HostFamily) %>%
dplyr::summarise(VRich_Mean = mean(VRich),
VRich_Median = median(VRich),
VRich_SEM = plotrix::std.error(VRich),
HostOrder = head(HostOrder, 1)) %>%
dplyr::arrange(desc(VRich_Mean)) %>%
dplyr::mutate(Year = year)
return(resx)
}
fam_over_time = do.call(rbind.data.frame, lapply(seq(1950, 2010, by=5), getFamilyVRich))
fot = reshape2::dcast(fam_over_time[ , c("HostFamily", "Year", "VRich_Mean")], HostFamily ~ Year, value.var="VRich_Mean")
# calculate spearman rank correlation between 2015 and all other years (examine temporal decay)
cor_rho = function(x){ return( as.vector(cor.test(fot$`2010`, x, method="spearman")$estimate) ) }
stab2 = as.data.frame(apply(fot[ , 2:ncol(fot)], 2, cor_rho)) %>%
rename("rho" = 1) %>%
dplyr::mutate(year = seq(1950, 2010, by=5),
model = "Family")
ggplot(rbind(stab1, stab2)) +
geom_line(aes(year, rho, col=model)) +
geom_point(aes(year, rho, col=model))
# 3. Species-level comparison of ranking of viral richness across years
# diversity estimates in 5 year increments
getSpeciesVRich = function(year){
resx = curves %>%
dplyr::filter(Year <= year) %>%
dplyr::filter(Host != "Homo sapiens") %>%
dplyr::filter(Domestic == FALSE) %>%
dplyr::group_by(Host) %>%
dplyr::summarise(VRich = sum(Discovered),
HostOrder = head(HostOrder, 1),
Domestic = head(Domestic, 1),
#Pubs = sum(NumPubs, na.rm=TRUE),
VRich_2015 = head(VRichness, 1)) %>%
dplyr::mutate(Year = year)
return(resx)
}
rich_over_time = do.call(rbind.data.frame, lapply(seq(1950, 2010, by=5), getSpeciesVRich))
# over time
rot2 = reshape2::dcast(rich_over_time[ , c("Host", "Year", "VRich")], Host ~ Year, value.var="VRich") %>%
left_join(rich_over_time[ !duplicated(rich_over_time$Host), c("Host", "HostOrder", "VRich_2015") ])
# run for all orders
result = data.frame()
orders = c("Carnivora", "Chiroptera", "Cetartiodactyla", "Lagomorpha", "Perissodactyla", "Primates", "Rodentia", "Diprotodontia", "Didelphimorphia")
for(i in 1:(length(orders)+2)){
if(i == 1){
datx = rot2
orderx = "Species"
} else if(i == 2){
datx = rot2[ rot2$VRich_2015 >= 5, ]
orderx = "Species (>5)"
} else{
orderx = orders[i-2]
datx = rot2[ rot2$HostOrder == orderx, ]
}
# run
cor_rho = function(x){ return( as.vector(cor.test(datx$`2010`, x, method="spearman")$estimate) ) }
resx = as.data.frame(apply(datx[ , 2:(ncol(datx)-2)], 2, cor_rho)) %>%
rename("rho" = 1) %>%
dplyr::mutate(model = orderx)
resx$year = seq(1950, 2010, by=5)
result = rbind(result, resx)
}
# stab3
stab3 = result
# ==================== combine all results ======================
stab_agg = do.call(rbind.data.frame, list(stab1, stab2, stab3[ grep("Species", stab3$model), ]))
stab_orders = stab3[ !grepl("Species", stab3$model), ]
# plots
ss = stab_agg[ stab_agg$model != "Species (>5)", ]
ss$model = factor(ss$model, levels=c("Order", "Family", "Species"), ordered=TRUE)
p1 = ggplot(ss) +
geom_point(aes(year, rho, col=model), size=1) +
geom_line(aes(year, rho, col=model), size=0.6) +
ylim(0, 1) +
scale_color_viridis_d(begin=0, end=0.8) +
theme_minimal() +
geom_vline(xintercept=2010, lty=2) +
ylab("Spearman rho (rank correlation)") +
xlab("Year") +
scale_x_continuous(breaks=seq(1950, 2010, by=10), labels =seq(1950, 2010, by=10)) +
theme(legend.title = element_blank(),
axis.title = element_text(size=13),
axis.text = element_text(size=11),
panel.grid.minor = element_blank(),
legend.text = element_text(size=12),
legend.position = c(0.2, 0.9))
p2 = ggplot(stab_orders) +
geom_point(aes(year, rho, col=model), size=1) +
geom_line(aes(year, rho, col=model), size=0.6) +
ylim(0, 1) +
scale_color_viridis_d(begin=0, end=0.8) +
facet_wrap(~model) +
theme_minimal() +
scale_x_continuous(breaks=seq(1950, 2010, by=20), labels =seq(1950, 2010, by=20)) +
theme(legend.position="none",
strip.text = element_text(size=12),
axis.title.x = element_text(size=13),
panel.grid.minor = element_blank(),
axis.text = element_text(size=11),
axis.title.y = element_blank()) +
geom_vline(xintercept=2010, lty=2) +
ylab("Spearman rho (rank correlation)") +
xlab("Year")
p2
head(stab_orders)
ggsave(p2, file="./output/figures/TemporalDecayOrders.png", device="png", dpi=600, units="in", width=8, height=6)
ggsave(p2, file="./output/figures/TemporalDecayOrders.png", device="png", dpi=600, units="in", width=9, height=6)
p2 = ggplot(stab_orders) +
geom_point(aes(year, rho, col=model), size=1) +
geom_line(aes(year, rho, col=model), size=0.6) +
ylim(0, 1) +
scale_color_viridis_d(begin=0, end=0.8) +
facet_wrap(~model) +
theme_minimal() +
#scale_x_continuous(breaks=seq(1950, 2010, by=20), labels =seq(1950, 2010, by=20)) +
theme(legend.position="none",
strip.text = element_text(size=12),
axis.title.x = element_text(size=13),
panel.grid.minor = element_blank(),
axis.text = element_text(size=11),
axis.title.y = element_blank()) +
geom_vline(xintercept=2010, lty=2) +
ylab("Spearman rho (rank correlation)") +
xlab("Year")
ggsave(p2, file="./output/figures/TemporalDecayOrders.png", device="png", dpi=600, units="in", width=7.5, height=6)
